<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>parse5 by inikulin</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>parse5</h1>
        <p>WHATWG HTML5 specification-compliant, fast and ready for production HTML parsing/serialization toolset for Node. </p>

        <p class="view"><a href="https://github.com/inikulin/parse5">View the Project on GitHub <small>inikulin/parse5</small></a></p>


        <ul>
          <li><a href="https://github.com/inikulin/parse5/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/inikulin/parse5/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/inikulin/parse5">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p align="center">
  <img src="https://raw.github.com/inikulin/parse5/master/logo.png" alt="parse5">
</p>

<p><em>WHATWG HTML5 specification-compliant, fast and ready for production HTML parsing/serialization toolset for Node and io.js.</em></p>

<p>I needed fast and ready for production HTML parser, which will parse HTML as a modern browser's parser.
Existing solutions were either too slow or their output was too inaccurate. So, this is how parse5 was born.</p>

<p><strong>Included tools:</strong></p>

<ul>
<li>  <a href="#class-parser">Parser</a> - HTML to DOM-tree parser.</li>
<li>  <a href="#class-simpleapiparser">SimpleApiParser</a> - <a href="http://en.wikipedia.org/wiki/Simple_API_for_XML">SAX</a>-style parser for HTML.</li>
<li>  <a href="#class-serializer">Serializer</a> - DOM-tree to HTML code serializer.</li>
</ul>

<h2>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h2>

<pre><code>$ npm install parse5
</code></pre>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<div class="highlight highlight-js"><pre><span class="pl-s">var</span> Parser <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>parse5<span class="pl-pds">'</span></span>).Parser;

<span class="pl-c">//Instantiate parser</span>
<span class="pl-s">var</span> parser <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Parser</span>();

<span class="pl-c">//Then feed it with an HTML document</span>
<span class="pl-s">var</span> <span class="pl-s3">document</span> <span class="pl-k">=</span> parser.<span class="pl-s3">parse</span>(<span class="pl-s1"><span class="pl-pds">'</span>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;Hi there!&lt;/body&gt;&lt;/html&gt;<span class="pl-pds">'</span></span>)

<span class="pl-c">//Now let's parse HTML-snippet</span>
<span class="pl-s">var</span> fragment <span class="pl-k">=</span> parser.parseFragment(<span class="pl-s1"><span class="pl-pds">'</span>&lt;title&gt;Parse5 is &amp;#102;&amp;#117;&amp;#99;&amp;#107;ing awesome!&lt;/title&gt;&lt;h1&gt;42&lt;/h1&gt;<span class="pl-pds">'</span></span>);
</pre></div>

<h2>
<a id="is-it-fast" class="anchor" href="#is-it-fast" aria-hidden="true"><span class="octicon octicon-link"></span></a>Is it fast?</h2>

<p>Check out <a href="https://github.com/inikulin/node-html-parser-bench">this benchmark</a>.</p>

<pre><code>Starting benchmark. Fasten your seatbelts...
html5 (https://github.com/aredridel/html5) x 0.18 ops/sec ±5.92% (5 runs sampled)
htmlparser (https://github.com/tautologistics/node-htmlparser/) x 3.83 ops/sec ±42.43% (14 runs sampled)
htmlparser2 (https://github.com/fb55/htmlparser2) x 4.05 ops/sec ±39.27% (15 runs sampled)
parse5 (https://github.com/inikulin/parse5) x 3.04 ops/sec ±51.81% (13 runs sampled)
Fastest is htmlparser2 (https://github.com/fb55/htmlparser2),parse5 (https://github.com/inikulin/parse5)
</code></pre>

<p>So, parse5 is as fast as simple specification incompatible parsers and ~15-times(!) faster than the current specification compatible parser available for the node.</p>

<h2>
<a id="api-reference" class="anchor" href="#api-reference" aria-hidden="true"><span class="octicon octicon-link"></span></a>API reference</h2>

<h3>
<a id="enum-treeadapters" class="anchor" href="#enum-treeadapters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enum: TreeAdapters</h3>

<p>Provides built-in tree adapters which can be passed as an optional argument to the <code>Parser</code> and <code>Serializer</code> constructors.</p>

<h4>
<a id="-treeadaptersdefault" class="anchor" href="#-treeadaptersdefault" aria-hidden="true"><span class="octicon octicon-link"></span></a>• TreeAdapters.default</h4>

<p>Default tree format for parse5.</p>

<h4>
<a id="-treeadaptershtmlparser2" class="anchor" href="#-treeadaptershtmlparser2" aria-hidden="true"><span class="octicon octicon-link"></span></a>• TreeAdapters.htmlparser2</h4>

<p>Quite popular <a href="https://github.com/fb55/htmlparser2">htmlparser2</a> tree format (e.g. used in <a href="https://github.com/MatthewMueller/cheerio">cheerio</a> and <a href="https://github.com/tmpvar/jsdom">jsdom</a>).</p>

<hr>

<h3>
<a id="class-parser" class="anchor" href="#class-parser" aria-hidden="true"><span class="octicon octicon-link"></span></a>Class: Parser</h3>

<p>Provides HTML parsing functionality.</p>

<h4>
<a id="-parserctortreeadapter-options" class="anchor" href="#-parserctortreeadapter-options" aria-hidden="true"><span class="octicon octicon-link"></span></a>• Parser.ctor([treeAdapter, options])</h4>

<p>Creates new reusable instance of the <code>Parser</code>. Optional <code>treeAdapter</code> argument specifies resulting tree format. If <code>treeAdapter</code> argument is not specified, <code>default</code> tree adapter will be used.</p>

<p><code>options</code> object provides the parsing algorithm modifications:</p>

<h5>
<a id="optionsdecodehtmlentities" class="anchor" href="#optionsdecodehtmlentities" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.decodeHtmlEntities</h5>

<p>Decode HTML-entities like <code>&amp;amp;</code>, <code>&amp;nbsp;</code>, etc.  Default: <code>true</code>. <strong>Warning:</strong> disabling this option may cause output which is not conform HTML5 specification.</p>

<h5>
<a id="optionslocationinfo" class="anchor" href="#optionslocationinfo" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.locationInfo</h5>

<p>Enables source code location information for the nodes. Default: <code>false</code>. When enabled, each node (except root node) has <code>__location</code> property, which contains <code>start</code> and <code>end</code> indices of the node in the source code. If element was implicitly created by the parser it's <code>__location</code> property will be <code>null</code>.</p>

<p><em>Example:</em></p>

<div class="highlight highlight-js"><pre><span class="pl-s">var</span> parse5 <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>parse5<span class="pl-pds">'</span></span>);

<span class="pl-c">//Instantiate new parser with default tree adapter</span>
<span class="pl-s">var</span> parser1 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">parse5.Parser</span>();

<span class="pl-c">//Instantiate new parser with htmlparser2 tree adapter</span>
<span class="pl-s">var</span> parser2 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">parse5.Parser</span>(parse5.TreeAdapters.htmlparser2);</pre></div>

<h4>
<a id="-parserparsehtml" class="anchor" href="#-parserparsehtml" aria-hidden="true"><span class="octicon octicon-link"></span></a>• Parser.parse(html)</h4>

<p>Parses specified <code>html</code> string. Returns <code>document</code> node.</p>

<p><em>Example:</em></p>

<div class="highlight highlight-js"><pre><span class="pl-s">var</span> <span class="pl-s3">document</span> <span class="pl-k">=</span> parser.<span class="pl-s3">parse</span>(<span class="pl-s1"><span class="pl-pds">'</span>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;Hi there!&lt;/body&gt;&lt;/html&gt;<span class="pl-pds">'</span></span>);</pre></div>

<h4>
<a id="-parserparsefragmenthtmlfragment-contextelement" class="anchor" href="#-parserparsefragmenthtmlfragment-contextelement" aria-hidden="true"><span class="octicon octicon-link"></span></a>• Parser.parseFragment(htmlFragment, [contextElement])</h4>

<p>Parses given <code>htmlFragment</code>. Returns <code>documentFragment</code> node. Optional <code>contextElement</code> argument specifies context in which given <code>htmlFragment</code> will be parsed (consider it as setting <code>contextElement.innerHTML</code> property). If <code>contextElement</code> argument is not specified then <code>&lt;template&gt;</code> element will be used as a context and fragment will be parsed in 'forgiving' manner.</p>

<p><em>Example:</em></p>

<div class="highlight highlight-js"><pre><span class="pl-s">var</span> documentFragment <span class="pl-k">=</span> parser.parseFragment(<span class="pl-s1"><span class="pl-pds">'</span>&lt;table&gt;&lt;/table&gt;<span class="pl-pds">'</span></span>);

<span class="pl-c">//Parse html fragment in context of the parsed &lt;table&gt; element</span>
<span class="pl-s">var</span> trFragment <span class="pl-k">=</span> parser.parseFragment(<span class="pl-s1"><span class="pl-pds">'</span>&lt;tr&gt;&lt;td&gt;Shake it, baby&lt;/td&gt;&lt;/tr&gt;<span class="pl-pds">'</span></span>, documentFragment.<span class="pl-sc">childNodes</span>[<span class="pl-c1">0</span>]);</pre></div>

<hr>

<h3>
<a id="class-simpleapiparser" class="anchor" href="#class-simpleapiparser" aria-hidden="true"><span class="octicon octicon-link"></span></a>Class: SimpleApiParser</h3>

<p>Provides <a href="https://en.wikipedia.org/wiki/Simple_API_for_XML">SAX</a>-style HTML parsing functionality.</p>

<h4>
<a id="-simpleapiparserctorhandlers-options" class="anchor" href="#-simpleapiparserctorhandlers-options" aria-hidden="true"><span class="octicon octicon-link"></span></a>• SimpleApiParser.ctor(handlers, [options])</h4>

<p>Creates new reusable instance of the <code>SimpleApiParser</code>. <code>handlers</code> argument specifies object that contains parser's event handlers. Possible events and their signatures are shown in the example.</p>

<p><code>options</code> object provides the parsing algorithm modifications:</p>

<h5>
<a id="optionsdecodehtmlentities-1" class="anchor" href="#optionsdecodehtmlentities-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.decodeHtmlEntities</h5>

<p>Decode HTML-entities like <code>&amp;amp;</code>, <code>&amp;nbsp;</code>, etc.  Default: <code>true</code>. <strong>Warning:</strong> disabling this option may cause output which is not conform HTML5 specification.</p>

<h5>
<a id="optionslocationinfo-1" class="anchor" href="#optionslocationinfo-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.locationInfo</h5>

<p>Enables source code location information for the tokens. Default: <code>false</code>. When enabled, each node handler receives <code>location</code> object as it's last argument. <code>location</code> object contains <code>start</code> and <code>end</code> indices of the token in the source code.</p>

<p><em>Example:</em></p>

<div class="highlight highlight-js"><pre><span class="pl-s">var</span> parse5 <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>parse5<span class="pl-pds">'</span></span>);

<span class="pl-s">var</span> parser <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">parse5.SimpleApiParser</span>({
    <span class="pl-en">doctype</span>: <span class="pl-st">function</span>(<span class="pl-vpf">name</span>, <span class="pl-vpf">publicId</span>, <span class="pl-vpf">systemId</span> /*, [<span class="pl-vpf">location</span>] */) {
        <span class="pl-c">//Handle doctype here</span>
    },

    <span class="pl-en">startTag</span>: <span class="pl-st">function</span>(<span class="pl-vpf">tagName</span>, <span class="pl-vpf">attrs</span>, <span class="pl-vpf">selfClosing</span> /*, [<span class="pl-vpf">location</span>] */) {
        <span class="pl-c">//Handle start tags here</span>
    },

    <span class="pl-en">endTag</span>: <span class="pl-st">function</span>(<span class="pl-vpf">tagName</span> /*, [<span class="pl-vpf">location</span>] */) {
        <span class="pl-c">//Handle end tags here</span>
    },

    <span class="pl-en">text</span>: <span class="pl-st">function</span>(<span class="pl-vpf">text</span> /*, [<span class="pl-vpf">location</span>] */) {
        <span class="pl-c">//Handle texts here</span>
    },

    <span class="pl-en">comment</span>: <span class="pl-st">function</span>(<span class="pl-vpf">text</span> /*, [<span class="pl-vpf">location</span>] */) {
        <span class="pl-c">//Handle comments here</span>
    }
});</pre></div>

<h4>
<a id="-simpleapiparserparsehtml" class="anchor" href="#-simpleapiparserparsehtml" aria-hidden="true"><span class="octicon octicon-link"></span></a>• SimpleApiParser.parse(html)</h4>

<p>Raises parser events for the given <code>html</code>.</p>

<p><em>Example:</em></p>

<div class="highlight highlight-js"><pre><span class="pl-s">var</span> parse5 <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>parse5<span class="pl-pds">'</span></span>);

<span class="pl-s">var</span> parser <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">parse5.SimpleApiParser</span>({
    <span class="pl-en">text</span>: <span class="pl-st">function</span>(<span class="pl-vpf">text</span>) {
        <span class="pl-en">console</span><span class="pl-s3">.log</span>(text);
    }
});

parser.<span class="pl-s3">parse</span>(<span class="pl-s1"><span class="pl-pds">'</span>&lt;body&gt;Yo!&lt;/body&gt;<span class="pl-pds">'</span></span>);</pre></div>

<hr>

<h3>
<a id="class-serializer" class="anchor" href="#class-serializer" aria-hidden="true"><span class="octicon octicon-link"></span></a>Class: Serializer</h3>

<p>Provides tree-to-HTML serialization functionality.
<strong>Note:</strong> prior to v1.2.0 this class was called <code>TreeSerializer</code>. However, it's still accessible as <code>parse5.TreeSerializer</code> for backward compatibility.</p>

<h4>
<a id="-serializerctortreeadapter-options" class="anchor" href="#-serializerctortreeadapter-options" aria-hidden="true"><span class="octicon octicon-link"></span></a>• Serializer.ctor([treeAdapter, options])</h4>

<p>Creates new reusable instance of the <code>Serializer</code>. Optional <code>treeAdapter</code> argument specifies input tree format. If <code>treeAdapter</code> argument is not specified, <code>default</code> tree adapter will be used.</p>

<p><code>options</code> object provides the serialization algorithm modifications:</p>

<h5>
<a id="optionsencodehtmlentities" class="anchor" href="#optionsencodehtmlentities" aria-hidden="true"><span class="octicon octicon-link"></span></a>options.encodeHtmlEntities</h5>

<p>HTML-encode characters like <code>&lt;</code>, <code>&gt;</code>, <code>&amp;</code>, etc.  Default: <code>true</code>.  <strong>Warning:</strong> disabling this option may cause output which is not conform HTML5 specification.</p>

<p><em>Example:</em></p>

<div class="highlight highlight-js"><pre><span class="pl-s">var</span> parse5 <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>parse5<span class="pl-pds">'</span></span>);

<span class="pl-c">//Instantiate new serializer with default tree adapter</span>
<span class="pl-s">var</span> serializer1 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">parse5.Serializer</span>();

<span class="pl-c">//Instantiate new serializer with htmlparser2 tree adapter</span>
<span class="pl-s">var</span> serializer2 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">parse5.Serializer</span>(parse5.TreeAdapters.htmlparser2);</pre></div>

<h4>
<a id="-serializerserializenode" class="anchor" href="#-serializerserializenode" aria-hidden="true"><span class="octicon octicon-link"></span></a>• Serializer.serialize(node)</h4>

<p>Serializes the given <code>node</code>. Returns HTML string.</p>

<p><em>Example:</em></p>

<div class="highlight highlight-js"><pre><span class="pl-s">var</span> <span class="pl-s3">document</span> <span class="pl-k">=</span> parser.<span class="pl-s3">parse</span>(<span class="pl-s1"><span class="pl-pds">'</span>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;Hi there!&lt;/body&gt;&lt;/html&gt;<span class="pl-pds">'</span></span>);

<span class="pl-c">//Serialize document</span>
<span class="pl-s">var</span> html <span class="pl-k">=</span> serializer.serialize(<span class="pl-s3">document</span>);

<span class="pl-c">//Serialize &lt;body&gt; element content</span>
<span class="pl-s">var</span> bodyInnerHtml <span class="pl-k">=</span> serializer.serialize(<span class="pl-s3">document</span>.<span class="pl-sc">childNodes</span>[<span class="pl-c1">0</span>].<span class="pl-sc">childNodes</span>[<span class="pl-c1">1</span>]);</pre></div>

<hr>

<h2>
<a id="testing" class="anchor" href="#testing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Testing</h2>

<p>Test data is adopted from <a href="https://github.com/html5lib">html5lib project</a>. Parser is covered by more than 8000 test cases.
To run tests:</p>

<pre><code>$ npm test
</code></pre>

<h2>
<a id="custom-tree-adapter" class="anchor" href="#custom-tree-adapter" aria-hidden="true"><span class="octicon octicon-link"></span></a>Custom tree adapter</h2>

<p>You can create a custom tree adapter so parse5 can work with your own DOM-tree implementation.
Just pass your adapter implementation to the parser's constructor as an argument:</p>

<div class="highlight highlight-js"><pre><span class="pl-s">var</span> Parser <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>parse5<span class="pl-pds">'</span></span>).Parser;

<span class="pl-s">var</span> myTreeAdapter <span class="pl-k">=</span> {
   <span class="pl-c">//Adapter methods...</span>
};

<span class="pl-c">//Instantiate parser</span>
<span class="pl-s">var</span> parser <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Parser</span>(myTreeAdapter);</pre></div>

<p>Sample implementation can be found <a href="https://github.com/inikulin/parse5/blob/master/lib/tree_adapters/default.js">here</a>.
The custom tree adapter should implement all methods exposed via <code>exports</code> in the sample implementation.</p>

<h2>
<a id="questions-or-suggestions" class="anchor" href="#questions-or-suggestions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Questions or suggestions?</h2>

<p>If you have any questions, please feel free to create an issue <a href="https://github.com/inikulin/parse5/issues">here on github</a>.</p>

<h2>
<a id="author" class="anchor" href="#author" aria-hidden="true"><span class="octicon octicon-link"></span></a>Author</h2>

<p><a href="https://github.com/inikulin">Ivan Nikulin</a> (<a href="mailto:ifaaan@gmail.com">ifaaan@gmail.com</a>)</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/inikulin">inikulin</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>